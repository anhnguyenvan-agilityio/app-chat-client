(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(e,t,a){e.exports=a(83)},60:function(e,t,a){},61:function(e,t,a){},69:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(40),r=a(0),c=a.n(r),o=a(43),s=a.n(o),i=a(31),l=a(50),m=a(52),u=a(10),d=a(49),p=a(48),h=a(8),v=a(2),g=a(21),f=a(16),E=(a(60),a(24)),b=a(25),N=a(29),y=a(26),O=a(30),C=(a(61),c.a.forwardRef(function(e,t){return c.a.createElement("div",{className:"form-label-group"},c.a.createElement("input",{ref:t,type:e.type,id:e.id,className:"form-control",placeholder:e.title,value:e.value,required:!0}),c.a.createElement("label",{htmlFor:e.id},e.title))})),_=function(){var e=localStorage.getItem("user");return e?JSON.parse(e):null},j=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(N.a)(this,Object(y.a)(t).call(this,e))).signIn=function(e){e.preventDefault(),a.props.login({variables:{user:{email:a.refs.email.value,password:a.refs.password.value}}})},a.state={},a}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentWillMount",value:function(){_()&&this.props.history.push("/home")}},{key:"render",value:function(){return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm-9 col-md-7 col-lg-5 mx-auto"},c.a.createElement("div",{className:"card-login card-signin my-5"},c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title text-center"},"Sign In"),c.a.createElement("form",{className:"form-signin"},c.a.createElement(C,{ref:"email",title:"Email address",id:"inputEmail",type:"email"}),c.a.createElement(C,{ref:"password",title:"Password",id:"inputPassword",type:"password"}),c.a.createElement("button",{className:"btn btn-lg btn-primary btn-block text-uppercase",type:"submit",onClick:this.signIn},"Sign in")),c.a.createElement("p",{style:{marginTop:"30px",fontSize:"15px"}},"List Account"),c.a.createElement("p",{style:{fontSize:"12px"}},"ironman@gmail.com / password: 123456"),c.a.createElement("p",{style:{fontSize:"12px"}},"thor@gmail.com / password: 123456"),c.a.createElement("p",{style:{fontSize:"12px"}},"captainamerican@gmail.com / password: 123456"))))))}}]),t}(r.Component),w=a(14),x=a(15),I=a.n(x);function S(){var e=Object(w.a)(["\n  mutation Login($user: LoginInput!) {\n    login(user: $user) {\n      token\n      user {\n        id\n        name\n        email\n        avatar\n      }\n    }\n  }\n"]);return S=function(){return e},e}var k=I()(S()),D=function(e){return c.a.createElement(u.b,{mutation:k,onCompleted:function(t){var a=t.login;localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),e.history.push("/home")}},function(t,a){var n=a.error;return c.a.createElement(j,{history:e.history,login:t,error:n})})},$=(a(69),function(){return c.a.createElement("div",{className:"card-header"},c.a.createElement("div",{className:"input-group"},c.a.createElement("input",{type:"text",placeholder:"Search...",name:"",className:"form-control search"}),c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text search_btn"},c.a.createElement("i",{className:"fas fa-search"})))))}),T=a(51),G=function(e){return c.a.createElement("div",{className:"d-flex bd-highlight"},c.a.createElement("div",{className:"img_cont"},c.a.createElement("img",{src:e.image,className:"rounded-circle user_img",alt:""}),c.a.createElement("span",{className:"online_icon"})),c.a.createElement("div",{className:"user_info"},c.a.createElement("span",null,"Chat with ",e.name)),c.a.createElement("div",{className:"video_cam"},c.a.createElement("span",null,c.a.createElement("i",{className:"fas fa-video"})),c.a.createElement("span",null,c.a.createElement("i",{className:"fas fa-phone"}))),c.a.createElement("span",{id:"action_menu_btn",style:{marginRight:"20px",lineHeight:"70px"},onClick:e.logout},"Log out"))},U=function(e){return c.a.createElement("div",null,e.host?c.a.createElement("div",{className:"d-flex justify-content-end mb-4"},c.a.createElement("div",{className:"msg_cotainer_send"},c.a.createElement("p",{style:{marginBottom:"0px"}},e.content),c.a.createElement("span",{className:"msg_time_send"},e.time)),c.a.createElement("div",{className:"img_cont_msg"},c.a.createElement("img",{src:e.image,className:"rounded-circle user_img_msg",alt:""}))):c.a.createElement("div",{className:"d-flex justify-content-start mb-4"},c.a.createElement("div",{className:"img_cont_msg"},c.a.createElement("img",{src:e.image,className:"rounded-circle user_img_msg",alt:""})),c.a.createElement("div",{className:"msg_cotainer"},c.a.createElement("p",{style:{marginBottom:"0px"}},e.content),c.a.createElement("span",{className:"msg_time"},e.time))))},A=function(e){var t="";if(e){var a=new Date(e),n=new Date;t=a.getDate()===n.getDate()&&a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()?"Today "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds():a.toLocaleString()}return t};function M(){var e=Object(w.a)(["\n  subscription chatAdded($channel: String!) {\n    chatAdded(channel: $channel) {\n      conversationID\n      author\n      content\n      createdAt\n    }\n  }\n"]);return M=function(){return e},e}var q=I()(M()),L=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(N.a)(this,Object(y.a)(t).call(this,e))).renderListChat=function(){return a.state.contentChat.map(function(e,t){return c.a.createElement(U,{host:e.host,image:e.avatar,content:e.content,time:e.createdAt,key:t})})},a.submitChat=function(e){e.preventDefault(),a.refs.contentChat.value&&a.conversationID&&a.props.chat({conversationID:a.conversationID,author:a.host.id,content:a.refs.contentChat.value}),a.refs.contentChat.value=""},a.state={user:{},contentChat:[]},a.host=_(),a.conversationID="",a}return Object(O.a)(t,e),Object(b.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;!e.loadingGetUser&&e.user&&this.setState({user:{name:e.user.name,avatar:e.user.avatar}});var a=[];e.loadingGetConversation||(this.conversationID=e.conversationID,this.sub&&this.sub(),this.sub=this.props.subscribeToMore({document:q,variables:{channel:this.conversationID},updateQuery:function(e,a){var n=a.subscriptionData;return{getConversation:{contentChat:[].concat(Object(T.a)(e.getConversation.contentChat),[n.data.chatAdded]),conversationID:t.conversationID,__typename:"GetConversationResponse"}}}}),a=e.contentChat.map(function(a){return{host:t.host.id===a.author,content:a.content,avatar:t.host.id===a.author?t.host.avatar:e.user.avatar,createdAt:A(a.createdAt)}})),this.setState({contentChat:a},function(){t.refs.scroll.scrollTop=t.refs.scroll.scrollHeight-t.refs.scroll.clientHeight})}},{key:"render",value:function(){var e=this,t=this.state.user;return c.a.createElement(r.Fragment,null,c.a.createElement("div",{className:"card-header msg_head"},c.a.createElement(G,{image:t.avatar,name:t.name,logout:function(){localStorage.clear(),e.props.history.push("/")}})),c.a.createElement("div",{className:"card-body msg_card_body",ref:"scroll"},this.renderListChat()),c.a.createElement("form",{className:"card-footer"},c.a.createElement("div",{className:"input-group"},c.a.createElement("div",{className:"input-group-append"},c.a.createElement("span",{className:"input-group-text attach_btn"},c.a.createElement("i",{className:"fas fa-paperclip"}))),c.a.createElement("input",{ref:"contentChat",name:"",className:"form-control type_msg",placeholder:"Type your message..."}),c.a.createElement("div",{className:"input-group-append"},c.a.createElement("button",{className:"input-group-text send_btn",type:"submit",onClick:this.submitChat},c.a.createElement("i",{className:"fas fa-location-arrow"}))))))}}]),t}(r.Component);function z(){var e=Object(w.a)(["\n  mutation Chat($message: MessageInput!) {\n    chat(message: $message)\n  }\n"]);return z=function(){return e},e}function F(){var e=Object(w.a)(["\n  query GetConversation($clientOne: String!, $clientTwo: String!) {\n    getConversation(clientOne: $clientOne, clientTwo: $clientTwo) {\n      conversationID\n      contentChat {\n        conversationID\n        author\n        content\n        createdAt\n      }\n    }\n  }\n"]);return F=function(){return e},e}function H(){var e=Object(w.a)(["\n  query GetUser($id: String!) {\n    getUser(id: $id) {\n      id\n      name\n      email\n      avatar\n    }\n  }\n"]);return H=function(){return e},e}var J=I()(H()),P=I()(F()),R=I()(z()),B=Object(u.c)(Object(u.d)(J,{options:function(e){return{variables:{id:e.match.params.id}}},props:function(e){return{loadingGetUser:e.data.loading,errorGetUser:e.data.error,user:e.data.getUser||[],hitory:e.hitory}}}),Object(u.d)(P,{options:function(e){return{variables:{clientOne:_().id,clientTwo:e.match.params.id}}},props:function(e){return{loadingGetConversation:e.data.loading,errorGetConversation:e.data.error,contentChat:e.data.getConversation&&e.data.getConversation.contentChat||[],conversationID:e.data.getConversation&&e.data.getConversation.conversationID||[],subscribeToMore:e.data.subscribeToMore}}}),Object(u.d)(R,{props:function(e){return{chat:function(t){return e.mutate({variables:{message:t}})}}}}))(L),W=function(e){return c.a.createElement("li",{className:!0===e.active?"active":""},c.a.createElement("div",{className:"d-flex bd-highlight"},c.a.createElement("div",{className:"img_cont"},c.a.createElement("img",{src:e.image,className:"rounded-circle user_img",alt:""}),c.a.createElement("span",{className:"online_icon ".concat("online"===e.status?"":"offline")})),c.a.createElement("div",{className:"user_info"},c.a.createElement("span",null,e.name),c.a.createElement("p",null,e.content))))},Y=function(e){return c.a.createElement(f.b,{path:e.to,exact:e.activeOnlyWhenExact,children:function(t){var a=t.match;return c.a.createElement("div",{className:a?"active":""},c.a.createElement(g.b,{to:e.to},e.children))}})},Q=function(e){var t=e.users.map(function(t,a){return c.a.createElement(Y,{to:"".concat(e.match.url,"/").concat(t.id),key:a},c.a.createElement(W,{image:t.avatar,status:"online",name:t.name,content:"".concat(t.name," is active")}))});return c.a.createElement("div",{className:"card-body contacts_body"},c.a.createElement("div",{className:"contacts"},t))},K=a(53),V=function(e){var t=e.component,a=Object(K.a)(e,["component"]);return c.a.createElement(f.b,Object.assign({},a,{render:function(e){return localStorage.getItem("token")?c.a.createElement(t,e):c.a.createElement(f.a,{to:{pathname:"/",state:{from:e.location}}})}}))},X=function(e){return c.a.createElement("div",{className:"container-fluid h-100"},c.a.createElement("div",{className:"row justify-content-center h-100"},c.a.createElement("div",{className:"col-md-4 col-xl-3 chat"},c.a.createElement("div",{className:"card mb-sm-3 mb-md-0 contacts_card"},c.a.createElement($,null),c.a.createElement(Q,{match:e.match,users:e.users}))),c.a.createElement("div",{className:"col-md-8 col-xl-6 chat"},c.a.createElement("div",{className:"card"},c.a.createElement(V,{path:"".concat(e.match.url,"/:id"),component:B})))))};function Z(){var e=Object(w.a)(["\n  query GetUsers {\n    getUsers {\n      id\n      name\n      email\n      avatar\n    }\n  }\n"]);return Z=function(){return e},e}var ee=I()(Z()),te=Object(u.c)(Object(u.d)(ee,{options:function(e){return{fetchPolicy:"cache-and-network"}},props:function(e){return{loading:e.data.loading,error:e.data.error,users:e.data.getUsers?e.data.getUsers.filter(function(e){var t=_();return e.id!==t.id}):[]}}}))(X);a.d(t,"client",function(){return se});var ae=Object(m.a)({uri:"https://demo-server-chat-app.herokuapp.com/graphql"}),ne=new p.a({uri:"wss://demo-server-chat-app.herokuapp.com/graphql",options:{reconnect:!0}}),re=Object(d.a)(function(e,t){var a=t.headers,r=localStorage.getItem("token"),c=Object(n.a)({},a);return r&&(c.authorization=r),{headers:Object(n.a)({},c)}}),ce=Object(h.d)(function(e){var t=e.query,a=Object(v.l)(t),n=a.kind,r=a.operation;return"OperationDefinition"===n&&"subscription"===r},ne,re.concat(ae)),oe=new l.a,se=new i.a({link:ce,cache:oe});s.a.render(c.a.createElement(u.a,{client:se},c.a.createElement(g.a,null,c.a.createElement(f.b,{exact:!0,path:"/",component:D}),c.a.createElement(V,{path:"/home",component:te}))),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.64309e69.chunk.js.map